# 05. 메서드 재정의와 가상 메서드 원리

## 💡 참고사항: 메모리 구조

![image](https://user-images.githubusercontent.com/27791880/151688102-5ca0d875-b1cc-45d2-92df-64c18b526aba.png)

* 코드 영역

    * 실행할 프로그램의 코드가 저장되는 영역(텍스트 영역)

    * CPU는 코드 영역에 저장된 명령어를 하나씩 가져가서 실행한다.

* 데이터 영역

    * 프로그램의 전역 변수와 정적 변수가 저장되는 영역이다.

    * 프로그램의 시작과 함께 할당되고, 프로그램이 종료되면 소멸한다.

* 스택 영역

    * 메모리의 스택(stack) 영역은 함수의 호출과 관계되는 **지역 변수**와 **매개변수**가 저장되는 영역이다.

    * 함수의 호출과 함께 할당되며, 함수의 호출이 완료되면 소멸한다.

    * 스택 영역에 저장되는 함수의 호출 정보를 stack frame이라고 한다.

    * push로 데이터를 저장하고, pop으로 데이터를 인출한다.

    * LIFO 방식에 따라 동작하므로, 가장 늦게 저장된 데이터가 가장 먼저 인출된다.

    * 메모리의 높은 주소에서부터 낮은 주소의 방향으로 할당된다.

* 힙 영역

    * 사용자가 직접 관리할 수 있는 메모리 영역.

    * 사용자에 의해 메모리 공간이 동적으로 할당되고 해제되며, 메모리의 낮은 주소에서 높은 주소의 방향으로 할당된다.

## 1) 메서드는 어떻게 호출되고 실행될까?

* 메서드(함수)의 이름은 주소값을 나타냄

* 메서드는 명령어 set(집합)이고, 프로그램이 로드되면 코드 영역에 명령어 set이 위치한다.

* 메서드가 호출되면 명령어 set이 존재하는 주소를 찾아서 각각의 명령어를 실행한다.

* 이 때, 메서드에서 사용하는 변수들은 스택 메모리에 존재한다. 따라서 다른 인스턴스에서 해당 메서드를 호출한다고 하더라도 같은 메서드의 코드는 동일하기 때문에 같은 메서드가 호출된다.

* 인스턴스가 생성되었을 때 변수는 힙 메모리에 따로 생성되어도 메서드 명령어 set은 처음 한 번만 로드된다.

## 2) 가상 메서드 원리

* 가상 메서드 테이블은 해당 메서드에 대한 주소를 가지고 있다.

* 재정의된 경우는 재정의된 메서드의 주소를 가리킨다.

![image](https://user-images.githubusercontent.com/27791880/151696207-b9eca336-ff1e-4dfa-9c39-dc102bcd8e03.png)

![image](https://user-images.githubusercontent.com/27791880/151696215-3d6f91ef-d513-47f8-a2ea-39b6eb64ab66.png)

<br/>

---
## Reference
[TCP스쿨: 메모리의 구조](http://www.tcpschool.com/c/c_memory_structure)